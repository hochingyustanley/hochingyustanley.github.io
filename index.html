<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>YMCAHK The Beacon å¾©æ´»å°‹å¯¶ ğŸ°ğŸ¥š</title>
    <!-- åŸºç¤åº«è¼‰å…¥ -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/lucide-static@0.321.0/font/lucide.css" rel="stylesheet">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+HK:wght@400;500;700;900&display=swap');
        body { 
            font-family: 'Noto Sans HK', sans-serif; 
            background-color: #fff7ed; /* å¾©æ´»ç¯€æš–é»ƒèƒŒæ™¯ bg-orange-50 */
            -webkit-tap-highlight-color: transparent;
        }
        .animate-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .shake { animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both; }
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }

        #qr-reader {
            width: 100% !important;
            border: none !important;
            background: #fff;
            border-radius: 1.5rem;
            overflow: hidden;
        }
        
        /* å¾©æ´»ç¯€è£é£¾åœ“é»èƒŒæ™¯ */
        .easter-bg {
            background-image: radial-gradient(#fde68a 2px, transparent 2px);
            background-size: 20px 20px;
        }
    </style>
</head>
<body class="easter-bg">
    <div id="root">
        <div class="flex items-center justify-center min-h-screen">
            <div class="text-pink-500 font-bold animate-pulse flex flex-col items-center gap-2">
                <span class="text-4xl">ğŸ°</span>
                <span>å°‹å¯¶æº–å‚™ä¸­...</span>
            </div>
        </div>
    </div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const App = () => {
            // è¨­å®šå€
            const correctAnswers = { 1: 'B', 2: 'B', 3: 'B', 4: 'B', 5: 'A' };
            const taskCodes = { 1: 'A7B2', 2: 'K9X4', 3: 'P3M8', 4: 'R5W1', 5: 'E2T6' };
            const STAFF_PASSCODE = "HELP88"; // è·å“¡å°ˆç”¨ç¢¼

            const tasks = [
                { id: 1, location: 'é¢å‘èˆˆè¯è¡— (ç»ç’ƒå¹•ç‰†)', hint: 'ç•™æ„çª—å¤–çš„èŠ±åœ’å½¢ç‹€...' },
                { id: 2, location: 'é¢å‘è˜‡å±‹é‚¨ (åŒ—é¢çª—æˆ¶)', hint: 'è§€å¯Ÿå¤§å»ˆçš„åå­—...' },
                { id: 3, location: 'é¢å‘é †å¯§é“ (èˆŠå€æ–¹å‘)', hint: 'èä¸€èç©ºæ°£ä¸­çš„è±†é¦™...' },
                { id: 4, location: 'ä¸­å¿ƒå¤§å ‚ (æ–°è¨­æ–½å€)', hint: 'çœ‹çœ‹æˆ‘å€‘çš„è¨­è¨ˆæ¦‚å¿µ...' },
                { id: 5, location: 'ä¸­å¿ƒæ­£é–€ (å…¥å£è™•)', hint: 'æ­¡è¿ä¾†åˆ° The Beacon...' }
            ];

            // éŠæˆ²ç‹€æ…‹å­˜å„²
            const [userAnswers, setUserAnswers] = useState(() => {
                const saved = localStorage.getItem('beacon_answers');
                return saved ? JSON.parse(saved) : {};
            });
            
            const [gameState, setGameState] = useState('list'); 
            const [activeTask, setActiveTask] = useState(null);
            const [manualCode, setManualCode] = useState('');
            const [manualCodeError, setManualCodeError] = useState('');
            const [currentTime, setCurrentTime] = useState(new Date().toLocaleTimeString());
            const [uniqueId, setUniqueId] = useState('');
            
            // æŠ€èƒ½èˆ‡éŒ¯èª¤ç‹€æ…‹
            const [hasUsed5050, setHasUsed5050] = useState(() => localStorage.getItem('used_5050') === 'true');
            const [is5050Active, setIs5050Active] = useState(false);
            const [fiftyFiftyOptions, setFiftyFiftyOptions] = useState(null); 
            const [wrongOptions, setWrongOptions] = useState([]); 
            
            // è·å“¡æç¤ºç‹€æ…‹
            const [hasUsedStaffHint, setHasUsedStaffHint] = useState(() => localStorage.getItem('used_staff') === 'true');
            const [showStaffInput, setShowStaffInput] = useState(false);
            const [staffCodeInput, setStaffCodeInput] = useState('');
            const [staffError, setStaffError] = useState('');

            // å†·å»æ©Ÿåˆ¶ç‹€æ…‹ (20ç§’å€’æ•¸)
            const [cooldown, setCooldown] = useState(0);

            // é‡ç½®ç¢ºèªç‹€æ…‹
            const [showResetConfirm, setShowResetConfirm] = useState(false);
            
            // æ¯é¡Œå˜—è©¦æ¬¡æ•¸è¨˜éŒ„
            const [attempts, setAttempts] = useState(() => {
                const saved = localStorage.getItem('beacon_attempts');
                return saved ? JSON.parse(saved) : {};
            });

            const [feedback, setFeedback] = useState(null); 
            const scannerInstance = useRef(null);

            // åˆå§‹åŒ–èˆ‡æ™‚é˜
            useEffect(() => {
                const timer = setInterval(() => setCurrentTime(new Date().toLocaleTimeString()), 1000);
                let savedId = localStorage.getItem('beacon_quest_user_id');
                if (!savedId) {
                    savedId = `BEACON-${Math.floor(100000 + Math.random() * 900000)}`;
                    localStorage.setItem('beacon_quest_user_id', savedId);
                }
                setUniqueId(savedId);

                if (window.lucide) window.lucide.createIcons();
                return () => clearInterval(timer);
            }, []);

            // å€’æ•¸è¨ˆæ™‚å™¨ Logic
            useEffect(() => {
                let timerId;
                if (cooldown > 0) {
                    timerId = setTimeout(() => {
                        setCooldown(prev => prev - 1);
                    }, 1000);
                }
                return () => clearTimeout(timerId);
            }, [cooldown]);

            // æƒæå™¨é‚è¼¯
            useEffect(() => {
                if (gameState === 'scan') {
                    const html5QrCode = new Html5Qrcode("qr-reader");
                    html5QrCode.start({ facingMode: "environment" }, { fps: 10, qrbox: 250 }, (text) => {
                        try {
                            const url = new URL(text);
                            const tid = parseInt(url.searchParams.get('task'));
                            const found = tasks.find(t => t.id === tid);
                            if (found) {
                                html5QrCode.stop().then(() => {
                                    startTask(found);
                                });
                            }
                        } catch (e) {}
                    }).catch(() => {});
                    scannerInstance.current = html5QrCode;
                }
                return () => { if (scannerInstance.current?.isScanning) scannerInstance.current.stop(); };
            }, [gameState]);

            const startTask = (task) => {
                setActiveTask(task);
                setIs5050Active(false);
                setFiftyFiftyOptions(null);
                setWrongOptions([]); 
                setFeedback(null);
                setShowStaffInput(false);
                setStaffCodeInput('');
                setStaffError('');
                setCooldown(0); // ç¢ºä¿æ¯æ¬¡é€²å…¥ä»»å‹™æ™‚æ²’æœ‰å†·å»
                setGameState('quiz');
            };

            const handleManualSubmit = (e) => {
                e.preventDefault();
                setManualCodeError('');
                const tid = Object.keys(taskCodes).find(k => taskCodes[k] === manualCode.toUpperCase().trim());
                if (tid) {
                    startTask(tasks.find(t => t.id === parseInt(tid)));
                    setManualCode('');
                } else {
                    setManualCodeError('ç„¡æ•ˆç·¨ç¢¼ï¼Œè«‹æª¢æŸ¥è¼¸å…¥æ˜¯å¦æ­£ç¢ºï¼');
                }
            };

            const use5050 = () => {
                if (hasUsed5050) return;
                const correct = correctAnswers[activeTask.id];
                let availableIncorrect = ['A', 'B', 'C', 'D'].filter(o => o !== correct && !wrongOptions.includes(o));
                const randomIncorrect = availableIncorrect[Math.floor(Math.random() * availableIncorrect.length)];
                setFiftyFiftyOptions([correct, randomIncorrect]);
                setHasUsed5050(true);
                localStorage.setItem('used_5050', 'true');
                setIs5050Active(true);
            };

            const handleAnswer = (option) => {
                if (feedback || cooldown > 0) return; // å†·å»ä¸­æˆ–å·²æœ‰çµæœæ™‚ä¸å¯é»æ“Š

                const isCorrect = option === correctAnswers[activeTask.id];
                const currentAttempts = (attempts[activeTask.id] || 0) + 1;
                
                const newAttempts = { ...attempts, [activeTask.id]: currentAttempts };
                setAttempts(newAttempts);
                localStorage.setItem('beacon_attempts', JSON.stringify(newAttempts));

                if (isCorrect) {
                    setFeedback({ type: 'success', message: 'ç­”å°äº†ï¼å¤ªå²å®³äº†ï¼' });
                    const newAns = { ...userAnswers, [activeTask.id]: option };
                    setUserAnswers(newAns);
                    localStorage.setItem('beacon_answers', JSON.stringify(newAns));
                    setTimeout(() => setGameState('list'), 1500);
                } else {
                    setWrongOptions(prev => [...prev, option]);

                    if (currentAttempts === 1) {
                        // ç¬¬ä¸€æ¬¡ç­”éŒ¯ï¼šå•Ÿå‹• 20 ç§’å†·å»ï¼Œä¸è¨­å®š feedback è®“ç•«é¢ç”± cooldown æ§åˆ¶
                        setCooldown(20);
                    } else {
                        // ç¬¬äºŒæ¬¡ç­”éŒ¯ï¼šç›´æ¥å¾¹åº•å¤±æ•—ï¼Œé¡¯ç¤ºæ‰¾è·å“¡
                        setFeedback({ type: 'error', message: 'å…©æ¬¡æ©Ÿæœƒå·²ç”¨å®Œï¼è«‹æ‰¾è·å“¡å”åŠ©ã€‚' });
                    }
                }
            };

            const handleStaffSubmit = () => {
                if (staffCodeInput.toUpperCase() === STAFF_PASSCODE) {
                    setHasUsedStaffHint(true);
                    localStorage.setItem('used_staff', 'true');
                    
                    const newAttempts = { ...attempts, [activeTask.id]: 0 };
                    setAttempts(newAttempts);
                    localStorage.setItem('beacon_attempts', JSON.stringify(newAttempts));
                    
                    setFeedback(null); 
                    setShowStaffInput(false);
                    setStaffCodeInput('');
                    setStaffError('');
                } else {
                    setStaffError('æˆæ¬Šç¢¼éŒ¯èª¤ï¼');
                }
            };

            const checkFinal = () => {
                if (Object.keys(userAnswers).length === tasks.length) {
                    setGameState('result');
                }
            };

            const resetProgress = () => {
                localStorage.clear();
                window.location.reload();
            };

            const isOptionHidden = (opt) => {
                if (wrongOptions.includes(opt)) return true;
                if (is5050Active && fiftyFiftyOptions && !fiftyFiftyOptions.includes(opt)) return true;
                return false;
            };

            return (
                <div className="min-h-screen max-w-md mx-auto relative overflow-x-hidden">
                    {/* å¾©æ´»ç¯€é¢¨æ ¼ Header */}
                    <header className="bg-gradient-to-r from-pink-400 to-orange-400 text-white p-6 rounded-b-[2.5rem] shadow-lg text-center relative overflow-hidden">
                        <div className="absolute top-0 left-0 w-full h-full bg-white/10" style={{ backgroundImage: 'radial-gradient(circle, rgba(255,255,255,0.3) 2px, transparent 2px)', backgroundSize: '20px 20px' }}></div>
                        <div className="relative z-10 flex flex-col items-center">
                            <span className="text-3xl mb-1">ğŸ°ğŸ¥š</span>
                            <h1 className="text-xl font-black tracking-widest uppercase text-white drop-shadow-md">The Beacon å¾©æ´»å°‹å¯¶</h1>
                            <p className="text-pink-100 text-[10px] mt-1 font-bold tracking-widest">YMCA OF HONG KONG</p>
                        </div>
                    </header>

                    <main className="p-5 relative z-10">
                        {gameState === 'list' && (
                            <div className="animate-in space-y-5">
                                <button onClick={() => setGameState('scan')} className="w-full bg-yellow-400 p-6 rounded-3xl font-black text-xl text-yellow-900 shadow-[0_8px_0_rgb(217,119,6)] active:translate-y-1 active:shadow-none transition-all flex items-center justify-center gap-3 border-2 border-yellow-300">
                                    <i data-lucide="scan" className="w-6 h-6"></i> æƒæ / è§£é–ä»»å‹™ ğŸ¥š
                                </button>

                                <div className="grid grid-cols-1 gap-3 pt-4">
                                    {tasks.map(t => (
                                        <div key={t.id} className={`p-5 rounded-2xl border-2 flex items-center justify-between transition-all ${userAnswers[t.id] ? 'bg-green-50 border-green-300' : 'bg-white border-pink-100 shadow-sm'}`}>
                                            <div className="flex items-center gap-4">
                                                <div className={`w-12 h-12 rounded-full flex items-center justify-center text-xl font-black ${userAnswers[t.id] ? 'bg-green-400 text-white shadow-lg' : 'bg-pink-100 text-pink-400 border border-pink-200'}`}>
                                                    {userAnswers[t.id] ? 'âœ“' : t.id}
                                                </div>
                                                <div>
                                                    <p className="text-[10px] font-black text-slate-400 uppercase flex items-center gap-1">Mission {userAnswers[t.id] && 'ğŸ¥š'}</p>
                                                    <p className="font-bold text-slate-700">{userAnswers[t.id] ? t.location : `å¾…è§£é–ä»»å‹™`}</p>
                                                </div>
                                            </div>
                                            {userAnswers[t.id] && <i data-lucide="check-circle-2" className="text-green-500 w-6 h-6"></i>}
                                        </div>
                                    ))}
                                </div>

                                <button onClick={checkFinal} disabled={Object.keys(userAnswers).length < tasks.length} className={`w-full py-5 rounded-2xl font-black text-lg mt-4 shadow-xl transition-all ${Object.keys(userAnswers).length === tasks.length ? 'bg-pink-500 text-white active:scale-95' : 'bg-slate-200 text-slate-400 opacity-50'}`}>
                                    å®Œæˆæ›é ˜ç¦®å“ ğŸ
                                </button>
                            </div>
                        )}

                        {gameState === 'scan' && (
                            <div className="animate-in space-y-6 text-center">
                                <div className="bg-white p-4 rounded-[2rem] shadow-xl border-2 border-pink-100">
                                    <div id="qr-reader"></div>
                                    <p className="text-[10px] text-pink-400 mt-4 font-bold">è«‹å°æº–ä»»å‹™è²¼ç´™ä¸Šçš„å¾©æ´»å½©è›‹ QR Code ğŸ°</p>
                                </div>
                                <div className="flex items-center gap-3 text-pink-300 font-bold px-4">
                                    <hr className="flex-1 border-pink-200" /> <span>æˆ–</span> <hr className="flex-1 border-pink-200" />
                                </div>
                                <form onSubmit={handleManualSubmit} className="bg-white p-6 rounded-[2rem] shadow-md border-2 border-pink-100 space-y-4">
                                    <h3 className="font-black text-pink-600">æ‰‹å‹•è¼¸å…¥ç·¨ç¢¼</h3>
                                    <div className="flex gap-2 w-full">
                                        <input type="text" maxLength="4" value={manualCode} onChange={e=>{setManualCode(e.target.value); setManualCodeError('');}} className="flex-1 min-w-0 w-full bg-pink-50 border-2 border-pink-100 rounded-xl px-3 py-3 text-center font-mono font-bold text-2xl focus:border-pink-400 outline-none uppercase text-pink-700" placeholder="XXXX" />
                                        <button className="bg-pink-500 text-white px-5 shrink-0 whitespace-nowrap rounded-xl font-black active:scale-95 shadow-md">ç¢ºèª</button>
                                    </div>
                                    {manualCodeError && <p className="text-xs text-red-500 font-bold">{manualCodeError}</p>}
                                </form>
                                <button onClick={() => setGameState('list')} className="text-pink-400 font-bold px-8 py-2 rounded-full border-2 border-pink-200 bg-white shadow-sm">è¿”å›åˆ—è¡¨</button>
                            </div>
                        )}

                        {gameState === 'quiz' && activeTask && (
                            <div className="animate-in space-y-4">
                                <div className={`bg-white p-8 rounded-[2.5rem] shadow-2xl border-t-[12px] relative ${feedback?.type === 'success' ? 'border-green-400' : feedback?.type === 'error' ? 'border-red-400 shake' : cooldown > 0 ? 'border-orange-400' : 'border-yellow-400'}`}>
                                    
                                    <div className="absolute -top-4 left-1/2 -translate-x-1/2 flex gap-2">
                                        <span className="bg-pink-500 text-white px-4 py-1 rounded-full text-[10px] font-black shadow-sm">ä»»å‹™ #{activeTask.id}</span>
                                        {(attempts[activeTask.id] || 0) > 0 && !feedback && cooldown === 0 && (
                                            <span className="bg-orange-400 text-white px-4 py-1 rounded-full text-[10px] font-black shadow-sm italic text-xs animate-pulse">è£œç­”æ©Ÿæœƒ</span>
                                        )}
                                    </div>

                                    <p className="text-lg font-black text-slate-700 mb-2 mt-4 text-center">{activeTask.location}</p>
                                    
                                    {feedback ? (
                                        // æœ€çµ‚çµæœ (æˆåŠŸ æˆ– ç¬¬äºŒæ¬¡å¤±æ•—)
                                        <div className={`py-10 text-center animate-in`}>
                                            <div className="text-6xl mb-4">{feedback.type === 'success' ? 'ğŸ‰' : 'ğŸ¥€'}</div>
                                            <p className={`text-xl font-black ${feedback.type === 'success' ? 'text-green-500' : 'text-red-500'}`}>{feedback.message}</p>
                                            
                                            {feedback.type === 'error' && (attempts[activeTask.id] || 0) >= 2 && (
                                                <div className="mt-8">
                                                    {!showStaffInput ? (
                                                        <button onClick={() => setShowStaffInput(true)} className="bg-pink-500 text-white px-6 py-3 rounded-full font-bold text-sm flex items-center justify-center gap-2 mx-auto shadow-lg active:scale-95 transition-all">
                                                            <i data-lucide="shield-question" className="w-5 h-5 text-yellow-200"></i> å°‹æ±‚è·å“¡æç¤ºè§£é–
                                                        </button>
                                                    ) : (
                                                        <div className="bg-pink-50 p-4 rounded-2xl animate-in space-y-3 border-2 border-pink-100">
                                                            <p className="text-xs font-bold text-pink-600">è«‹äº¤çµ¦ç•¶å€¼è·å“¡è¼¸å…¥æˆæ¬Šç¢¼ï¼š</p>
                                                            <div className="flex gap-2 w-full">
                                                                <input type="password" placeholder="å¯†ç¢¼" value={staffCodeInput} onChange={e=>setStaffCodeInput(e.target.value)} className="flex-1 min-w-0 px-3 py-2 rounded-xl text-center font-bold tracking-widest focus:outline-none focus:ring-2 focus:ring-pink-400 border border-pink-200" />
                                                                <button onClick={handleStaffSubmit} className="bg-pink-500 text-white px-4 shrink-0 whitespace-nowrap rounded-xl font-bold">è§£é–</button>
                                                            </div>
                                                            {staffError && <p className="text-xs text-red-500 font-bold">{staffError}</p>}
                                                        </div>
                                                    )}
                                                </div>
                                            )}
                                        </div>
                                    ) : cooldown > 0 ? (
                                        // ç¬¬ä¸€æ¬¡å¤±æ•—ï¼š20ç§’å†·å»èˆ‡å¼·åˆ¶é–±è®€æç¤º
                                        <div className="py-6 text-center animate-in space-y-4">
                                            <div className="text-5xl animate-bounce">ğŸ™ˆ</div>
                                            <h3 className="text-xl font-black text-orange-500">å“å‘€ï¼Œç­”éŒ¯äº†ï¼</h3>
                                            <p className="text-slate-500 text-sm font-bold">è«‹åˆ©ç”¨å†·å»æ™‚é–“ï¼Œä»”ç´°é–±è®€ä¸‹æ–¹æç¤ºï¼š</p>
                                            
                                            <div className="text-5xl font-black text-pink-500 font-mono my-4 drop-shadow-sm">
                                                {cooldown}s
                                            </div>
                                            
                                            <div className="p-5 bg-orange-50 rounded-2xl text-left border-2 border-orange-200 shadow-inner relative overflow-hidden transform scale-105 transition-transform">
                                                <div className="absolute top-0 left-0 w-2 h-full bg-orange-400"></div>
                                                <p className="text-xs font-black text-orange-500 uppercase mb-2 flex items-center gap-1"><i data-lucide="lightbulb" className="w-4 h-4"></i> é—œéµæç¤º</p>
                                                <p className="text-base text-orange-900 font-bold leading-relaxed">{activeTask.hint}</p>
                                            </div>
                                            <p className="text-[10px] text-slate-400 font-bold mt-4 animate-pulse">å€’æ•¸çµæŸå¾Œå³å¯é€²è¡Œè£œç­”...</p>
                                        </div>
                                    ) : (
                                        // æ­£å¸¸ä½œç­”ç•«é¢
                                        <div className="space-y-6 pt-4 animate-in">
                                            <div className="grid grid-cols-2 gap-3">
                                                {['A', 'B', 'C', 'D'].map(opt => {
                                                    const hidden = isOptionHidden(opt);
                                                    return (
                                                        <button 
                                                            key={opt} 
                                                            disabled={hidden}
                                                            onClick={() => handleAnswer(opt)} 
                                                            className={`h-24 rounded-3xl text-3xl font-black transition-all transform ${
                                                                hidden 
                                                                ? 'opacity-20 bg-slate-200 text-slate-400 cursor-not-allowed scale-95 shadow-inner' 
                                                                : 'bg-yellow-50 border-2 border-yellow-200 text-yellow-800 active:bg-pink-400 active:text-white active:scale-95 shadow-sm active:border-pink-500'
                                                            }`}
                                                        >
                                                            {opt}
                                                        </button>
                                                    );
                                                })}
                                            </div>

                                            <div className="flex gap-2">
                                                <button 
                                                    onClick={use5050}
                                                    disabled={hasUsed5050}
                                                    className={`flex-1 py-3 rounded-xl font-black text-xs flex items-center justify-center gap-2 border-2 transition-all ${hasUsed5050 ? 'bg-slate-50 text-slate-300 border-slate-100' : 'bg-purple-50 text-purple-600 border-purple-200 active:scale-95 shadow-sm'}`}
                                                >
                                                    <i data-lucide="zap" className="w-4 h-4"></i> 50/50 (æ¯å ´é™ä¸€æ¬¡)
                                                </button>
                                            </div>

                                            <div className="p-4 bg-blue-50/50 rounded-2xl text-left border border-blue-100">
                                                <p className="text-[10px] font-black text-blue-400 uppercase mb-1 flex items-center gap-1"><i data-lucide="info" className="w-3 h-3"></i> Hint</p>
                                                <p className="text-sm text-blue-800 font-medium leading-relaxed">{activeTask.hint}</p>
                                            </div>
                                        </div>
                                    )}
                                </div>
                                {!feedback && cooldown === 0 && (
                                    <button onClick={() => setGameState('list')} className="w-full text-slate-400 font-bold py-2 mt-2">è¿”å›ä¸»é é¢</button>
                                )}
                            </div>
                        )}

                        {gameState === 'result' && (
                            <div className="animate-in space-y-6 mt-4">
                                <div className="bg-white p-8 rounded-[3rem] shadow-2xl border-4 border-pink-400 text-center relative overflow-hidden">
                                    <div className="absolute -top-10 -left-10 w-32 h-32 bg-pink-100 rounded-full"></div>
                                    <div className="absolute -bottom-10 -right-10 w-32 h-32 bg-yellow-100 rounded-full"></div>
                                    
                                    <div className="text-7xl mb-4 relative z-10 drop-shadow-md animate-bounce">ğŸ§º</div>
                                    <h2 className="text-3xl font-black text-pink-600 relative z-10">å°‹å¯¶å¤§æˆåŠŸï¼</h2>
                                    <p className="text-pink-400 text-xs mt-2 font-bold uppercase tracking-widest relative z-10">Easter Egg Hunter</p>
                                    
                                    <div className="my-8 bg-gradient-to-b from-slate-800 to-slate-900 p-8 rounded-[2rem] text-white shadow-xl relative z-10 border-2 border-slate-700">
                                        <p className="text-[10px] text-yellow-300 mb-3 font-black tracking-widest uppercase flex items-center justify-center gap-2"><span>âœ¨</span> E-Certificate ID <span>âœ¨</span></p>
                                        <p className="text-3xl font-mono font-black text-white tracking-tighter drop-shadow-[0_0_8px_rgba(255,255,255,0.5)]">{uniqueId}</p>
                                        <div className="mt-6 pt-6 border-t border-slate-700">
                                            <p className="text-xl font-black text-pink-200">{currentTime}</p>
                                            <p className="text-[10px] text-slate-400 mt-2 font-bold">è«‹å‘ YMCA è·å“¡å±•ç¤ºæ­¤ç•«é¢é ˜å–å¾©æ´»ç¯€ç¦®ç‰© ğŸ°</p>
                                        </div>
                                    </div>
                                    
                                    <div className="bg-green-50 text-green-600 py-4 rounded-2xl font-black text-sm border-2 border-green-200 flex items-center justify-center gap-2 relative z-10 shadow-sm">
                                        <i data-lucide="gift" className="w-5 h-5"></i> ç¦®ç‰©æ›é ˜è³‡æ ¼ç¢ºèª
                                    </div>
                                </div>
                                
                                {!showResetConfirm ? (
                                    <button onClick={() => setShowResetConfirm(true)} className="w-full text-slate-400 text-xs underline font-bold uppercase tracking-widest">Reset Progress</button>
                                ) : (
                                    <div className="bg-red-50 border-2 border-red-200 p-4 rounded-2xl text-center space-y-3 animate-in shadow-sm">
                                        <p className="text-xs text-red-600 font-black">è­¦å‘Šï¼šé‡ç½®å¾Œæ‰€æœ‰å°‹å¯¶é€²åº¦å°‡æ¶ˆå¤±ï¼</p>
                                        <div className="flex gap-2 justify-center">
                                            <button onClick={() => setShowResetConfirm(false)} className="px-5 py-2 bg-white border border-slate-200 rounded-xl text-xs font-bold text-slate-600">å–æ¶ˆ</button>
                                            <button onClick={resetProgress} className="px-5 py-2 bg-red-500 rounded-xl text-xs font-black text-white shadow-md active:scale-95">ç¢ºèªæ”¾æ£„</button>
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}
                    </main>

                    <footer className="py-8 text-center text-orange-300 relative z-10">
                        <p className="text-[9px] font-black tracking-[0.3em]">The Beacon â€¢ YMCA OF HONG KONG</p>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
